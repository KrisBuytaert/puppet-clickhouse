# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

* [`clickhouse`](#clickhouse): this class allows you to install ClickHouse DB's repo, client and server
* [`clickhouse::client`](#clickhouseclient): ClickHouse client class
* [`clickhouse::repo`](#clickhouserepo): installs repository with ClickHouse DBMS
* [`clickhouse::server`](#clickhouseserver): ClickHouse server class

**Defined types**

* [`clickhouse::client::config`](#clickhouseclientconfig): generates xml config from hash via ruby xml-simple
* [`clickhouse::server::config`](#clickhouseserverconfig): generates xml config from hash via ruby xml-simple

## Classes

### clickhouse

Top level class for ClickHouse DBMS installation and management.

#### Examples

##### Simple use

```puppet
include clickhouse
```

##### Install server and client

```puppet
class { 'clickhouse':
  server => true,
}
```

##### Install everything and manage repository

```puppet
class { 'clickhouse':
  server      => true,
  client      => true,
  manage_repo => true,
}
```

#### Parameters

The following parameters are available in the `clickhouse` class.

##### `server`

Data type: `Boolean`

Is clickhouse-server should be installed or not. It won't be installed by default, because some time you need the client only.

Default value: `false`

##### `client`

Data type: `Boolean`

Is clickhouse-client should be installed or not.

Default value: `true`

##### `manage_repo`

Data type: `Boolean`

Is apt or yum repository should be managed. Set to `false` by default to not affect your own repositories policy.

Default value: `false`

##### `user`

Data type: `String[1]`

User for configs owning. Strongly recommended staying default.

It's highly unrecommended to change default user, but feel free to shot in a knee.
You have to adjust as well the data directory and the whole configs everywhere.

Default value: 'clickhouse'

##### `group`

Data type: `String[1]`

Group for configs, see `user` parameter.

Default value: $user

### clickhouse::client

The class installs clickhouse-client.

#### Examples

##### Simple use

```puppet
include clickhouse::client
```

##### Use with params

```puppet
class { 'clickhouse::client':
  package_name   => 'clickhouse-client-custom',
  package_ensure => 'hold',
  user           => 'custom-user',
  conf_d_dir     => '/some/path',
}
```

#### Parameters

The following parameters are available in the `clickhouse::client` class.

##### `package_name`

Data type: `String[1]`

Package to be installed.

Default value: 'clickhouse-client'

##### `package_ensure`

Data type: `String[1]`

Client package `ensure`. See `ensure` attribute for `package` resource.

Default value: 'installed'

##### `conf_d_dir`

Data type: `Stdlib::Unixpath`

Directory for custom configs.

Default value: '/etc/clickhouse-client/conf.d'

### clickhouse::repo

Installs yum or apt repository for ClickHouse DBMS.

Uses Altinity repository for yum and yandex for apt.

#### Examples

##### Simple use

```puppet
include clickhouse::repo
```

### clickhouse::server

The class installs ClickHouse server and manages service

#### Examples

##### Simple use

```puppet
include clickhouse::server
```

##### Use with params

```puppet
class { 'clickhouse::server':
  package_name   => 'clickhouse-server-custom',
  package_ensure => 'latest',
  service_name   => 'clickhouse-server',
  service_ensure => false,
  service_enable => false,
}
```

#### Parameters

The following parameters are available in the `clickhouse::server` class.

##### `package_name`

Data type: `String[1]`

Server package to be installed.

Default value: 'clickhouse-server'

##### `package_ensure`

Data type: `String[1]`

Server package ensure. See `ensure` attribute for `package` resource.

Default value: 'installed'

##### `service_name`

Data type: `String[1]`

Name of the managed service for clickhouse-server.

Default value: $package_name

##### `service_ensure`

Data type: `Variant[Boolean, Enum[
        'running',
        'stopped'
    ]]`

Desired state for `$service_name`, see `ensure` for `service` resource.

Default value: 'running'

##### `service_enable`

Data type: `Variant[Boolean, Enum[
        'manual',
        'mask'
    ]]`

If `$service_name` should be enabled, see `enable` for `service` resource.

Default value: `true`

##### `conf_dir`

Data type: `Stdlib::Unixpath`

Directory with clickhouse-server configuration.

Default value: '/etc/clickhouse-server'

##### `conf_d_dir`

Data type: `Stdlib::Unixpath`

Directory with clickhouse-server included configuration.

Default value: "${conf_dir}/conf.d"

##### `users_d_dir`

Data type: `Stdlib::Unixpath`

Directory with clickhouse-server users configuration.

Default value: "${conf_dir}/users.d"

## Defined types

### clickhouse::client::config

This type creates custom configuration files for clickhouse-client.

#### Examples

##### Usage

```puppet
clickhouse::client::config { 'prompt':
  data => {'prompt_by_server_display_name' => [{
      'experimental' => ['{display_name} \x01\e[1;35m\x02:)\x01\e[0m\x02 '],
  }]},
}
#
# Will create file `/etc/clickhouse-client/conf.d/prompt.xml`:
# <config>
#   <prompt_by_server_display_name>
#     <experimental>{display_name} \x01\e[1;35m\x02:)\x01\e[0m\x02 </experimental>
#   </prompt_by_server_display_name>
# </config>
```

#### Parameters

The following parameters are available in the `clickhouse::client::config` defined type.

##### `data`

Data type: `Hash`

This hash will be converted into xml config placed in `$clickhouse::client::conf_d_dir`.

Root will be `<config>` by default.

##### `ensure`

Data type: `Enum[
        'present',
        'file',
        'absent'
    ]`

Subset of attribute `ensure` for `file` resource.

Default value: 'present'

##### `mode`

Data type: `String[1]`

Desired permissions mode for the config file, see `mode` attribute for `file` resource.

Default value: '0644'

### clickhouse::server::config

This type creates custom configuration files for clickhouse-server.

#### Examples

##### Usage

```puppet
clickhouse::server::config { 'macros':
  data    => {'macros' => [
      {'hostname' => ['host.domain.TLD'],}
  ]},
  section => 'config',
}
#
# Will create file `/etc/clickhouse-server/conf.d/macros.xml`:
# <yandex>
#   <macros>
#     <hostname>host.domain.TLD</hostname>
#   </macros>
# </yandex>
```

#### Parameters

The following parameters are available in the `clickhouse::server::config` defined type.

##### `data`

Data type: `Hash`

This hash will be converted into xml config placed in `$clickhouse::server::conf_d_dir`.

Root will be `<yandex>` by default.

##### `section`

Data type: `Enum['config', 'users']`

Should the file be created in configs or users include directory.

##### `ensure`

Data type: `Enum[
        'present',
        'file',
        'absent'
    ]`

Subset of attribute `ensure` for `file` type.

Default value: 'present'

##### `mode`

Data type: `String[1]`

Desired permissions mode for the config file, see `mode` attribute for `file` resource.

Default value: '0644'

